{"version":3,"sources":["webpack:///./src/components/hourglass.js","webpack:///./src/components/sky.js","webpack:///./src/misc/NIL001.js","webpack:///./config/theme.json"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,QAAQ;AACtB;AACA;AACO;;AAEP;AACA;AACA,aAAa,GAAG;AAChB,aAAa,OAAO;AACpB,aAAa,QAAQ;AACrB;AACA,sCAAsC,yCAAyC;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,CAAC;AAAA;AAAA;;;;;;;;;;;;;;;;AC3ID;AACA;AACA,cAAc,OAAO;AACrB,cAAc,aAAa;AAC3B;AACO;AACP;AACA,aAAa;AACb,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA,mBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C;AAC3C;AACA;AACA,qCAAqC,KAAK,GAAG,SAAS,IAAI,eAAe;AACzE,qCAAqC,KAAK,GAAG,SAAS,IAAI,eAAe;AACzE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,mBAAmB,4BAA4B;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAAA;AAAA;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;ACxFA;AAAA;AAAA;AAAA;AAAA;AAAuD;AACZ;AACM;AACjD,yBAAyB,IAAI,OAAO;AACpC;AACA;AACA;AACA,cAAc,UAAU;AACxB,cAAc,gBAAgB;AAC9B,cAAc,SAAS;AACvB,cAAc,OAAO;AACrB,cAAc,cAAc;AAC5B;AACA;AACA;AACA;AACA,aAAa,GAAG;AAChB,aAAa,OAAO,eAAe;AACnC;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,qBAAqB,gDAAK;AAC1B,yBAAyB,2EAAS,wBAAwB,0CAA0C;AACpG;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mBAAmB,+DAAG;;AAEtB;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,sEAAsE;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE;AAChE;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,GAAG;AACjB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,UAAU;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAc,UAAU;AACxB,cAAc,OAAO;AACrB,cAAc,oBAAoB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;;AAEA;AACA;AACA,CAAC;AAAA;AAAA;;;;;;;;ACrUD,kBAAkB,SAAS,ofAAof,WAAW,iDAAiD,YAAY,qBAAqB,SAAS,kEAAkE,UAAU,+BAA+B,WAAW,YAAY,WAAW,mEAAmE,WAAW,sHAAsH,WAAW,yBAAyB,WAAW,YAAY,WAAW,YAAY,WAAW,YAAY,WAAW,mEAAmE,WAAW,YAAY,WAAW,8BAA8B,WAAW,4GAA4G,WAAW,yCAAyC,gFAAgF,WAAW,mFAAmF,WAAW,sFAAsF,WAAW,yFAAyF,WAAW,iFAAiF,WAAW,qFAAqF,WAAW,2DAA2D,gFAAgF,WAAW,oGAAoG,WAAW,4GAA4G,WAAW,YAAY,WAAW,YAAY,WAAW,YAAY,WAAW,6HAA6H,WAAW,YAAY,WAAW,YAAY,WAAW,YAAY,WAAW,YAAY,WAAW,4BAA4B,4CAA4C,EAAE,8CAA8C,EAAE,+CAA+C,EAAE,4CAA4C,EAAE,+CAA+C,EAAE,4CAA4C,EAAE,WAAW,YAAY,WAAW,YAAY,WAAW,YAAY,WAAW,YAAY,WAAW,YAAY,WAAW,YAAY,WAAW,4BAA4B,6CAA6C,EAAE,+CAA+C,EAAE,6CAA6C,G","file":"5.js","sourcesContent":["const fully = '#66CC33';\r\nconst half = '#FFD400';\r\nconst scanty = '#FF3300';\r\nconst elapsed = '#848484';\r\n\r\n/**\r\n * 砂時計\r\n * Libries: p5\r\n * @property {number} startMillis - 開始タイミング\r\n * @property {number} timeLimit - 制限時間\r\n * @property {number} vh - ディスプレイの高さの1/100\r\n * @property {number} vw - ディスプレイの幅の1/100\r\n * @property {number} short - vhとvwの短い方\r\n * @property {boolean} isStart - スタートボタンが押されたかどうか\r\n *\r\n */\r\nexport class HourGlass {\r\n\r\n  /**\r\n   * 初期表示\r\n   * @param {p5} p\r\n   * @param {number} timeLimit - 制限時間\r\n   * @param {boolean} [isReturnEnable] - 戻るボタンの表示の有無\r\n   */\r\n  constructor(p, timeLimit, option = {isReturnEnable:false, isChangeColor:true}) {\r\n    this.p5 = p;\r\n    this.timeLimit = timeLimit;\r\n    this.option = option;\r\n    let shortView = p.windowHeight > p.windowWidth\r\n      ? 'vw'\r\n      : 'vh';\r\n    this.secGlass = new Date(this.timeLimit + this.startMillis - this.p5.millis());\r\n\r\n    // let div = p.createDiv('');\r\n    // div.id(\"hourglass\")\r\n    //   .style('position', 'fixed')\r\n    //   .style('top','10vw')\r\n    //   // .style('top', '7vw')\r\n    //   .style('left', '7vw')\r\n    //   .style('font-size', '3.5vw')\r\n    //   // .style('background-color', '#fff')\r\n    //   // .style('color', '#616161')\r\n    //   .style('width', '11vw')\r\n    //   .style('height', '11vw')\r\n    //   .style('border-radius', '50%')\r\n    //   .style('display', 'flex')\r\n    //   .style('align-items', 'center')\r\n    //   .style('justify-content', 'center')\r\n    //   .html(\"戻る\")\r\n    // ;\r\n    if (option.isReturnEnable) {\r\n      this.div = p.createButton('戻る')\r\n        .id(\"hourglass\")\r\n        .style('position', 'fixed')\r\n        // .style('top', '10vw')\r\n        .style('top', '4' + shortView)\r\n        .style('left', '4' + shortView)\r\n        .style('font-size', '3.5' + shortView)\r\n        .style('background-color', 'transparent')\r\n        // .style('color', '#616161')\r\n        .style('width', '17' + shortView)\r\n        .style('height', '17' + shortView)\r\n        // .style('border-radius', '50%')\r\n        .style('display', 'flex')\r\n        .style('align-items', 'center')\r\n        .style('justify-content', 'center')\r\n        .style('padding-top', '7' + shortView)\r\n        .style('border-style', 'none')\r\n        .mousePressed(() => {\r\n          if (App.isAndroid) Android.redo();\r\n        })\r\n      ;\r\n    }\r\n    this.isStart = false;\r\n  }\r\n\r\n  /**\r\n   * [p5] トレーニング開始時処理\r\n   */\r\n  start() {\r\n    this.startMillis = this.p5.millis();\r\n    this.p5.loop();\r\n    this.isStart = true;\r\n  }\r\n\r\n  /**\r\n   * [p5] 砂時計を描画\r\n   */\r\n  renderGlass(isVisible = true) {\r\n    this.vh = this.p5.windowHeight / 100;\r\n    this.vw = this.p5.windowWidth / 100;\r\n    this.short = this.p5.min(this.vh, this.vw);\r\n\r\n    // const hourglass = this.p5.select(\"#hourglass\");\r\n    this.secGlass = new Date(this.timeLimit + this.startMillis - this.p5.millis());\r\n    // let nowSec = (\"0\" + this.secGlass.getSeconds()).slice(-2);\r\n    // hourglass.html(\"戻る\");\r\n    /** 外枠部分 */\r\n    this.limitSec = this.timeLimit / 1000 - this.secGlass.getSeconds() - (this.secGlass.getMilliseconds() / 1000);\r\n    if (!isVisible)\r\n      return;\r\n    this.p5.noStroke();\r\n    this.p5.fill(fully);\r\n    if (this.option.isChangeColor && (this.timeLimit / 1000) / 2 > this.secGlass.getSeconds()){\r\n      this.p5.fill(half);\r\n    }\r\n    if (this.option.isChangeColor && (this.timeLimit / 1000) / 4 > this.secGlass.getSeconds()){\r\n      this.p5.fill(scanty);\r\n    }\r\n    this.p5.ellipseMode(this.p5.CORNER);\r\n    this.p5.ellipse(4 * this.short, 4 * this.short, 17 * this.short, 17 * this.short);\r\n    // this.p5.fill('#212121');\r\n    this.p5.fill(elapsed);\r\n    let rad = (360 / (this.timeLimit / 1000)) * this.limitSec * Math.PI / 180;\r\n    let s = -90 * Math.PI / 180;\r\n    if (this.isOver) {\r\n      this.p5.arc(4 * this.short, 4 * this.short, 17 * this.short, 17 * this.short, s, s - 0.001 )\r\n    } else {\r\n      this.p5.arc(4 * this.short, 4 * this.short, 17 * this.short, 17 * this.short, s, s + rad + 0.001);\r\n    }\r\n    // if (!this.isStart){\r\n    //   this.p5.select(\"#hourglass\").html(this.timeLimit / 1000);\r\n    // }\r\n    this.p5.ellipseMode(this.p5.CENTER);\r\n  }\r\n\r\n  /**\r\n   * [p5] タイムオーバー判定\r\n   * @returns {boolean} 経過した：true 経過していない:false\r\n   */\r\n  get isOver() {\r\n    this.endTime = this.p5.millis();\r\n    return (this.p5.millis() > (this.timeLimit + this.startMillis));\r\n  }\r\n\r\n  get limit() {\r\n    return this.secGlass.getSeconds() + (this.secGlass.getMilliseconds() / 1000)\r\n  }\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/hourglass.js\n// module id = 10\n// module chunks = 0 1 2 4 5 6","/**\r\n * 空\r\n * @property {number} sunHeight - 日の位置の高さ。一番下になると日没になります。\r\n * @property {array<Start>} stars - 星々\r\n */\r\nexport class Sky{\r\n  /**\r\n   * @param {p5}\r\n   * @param {number} height - 空領域の高さ\r\n   */\r\n  constructor($p, height){\r\n    this.$p5 = $p;\r\n    this.stars = [];\r\n    for (var i = 0; i < 50; i++) {\r\n      let s = new Star(this.$p5);\r\n      this.stars.push(s);\r\n    }\r\n    this.sunHeight = 0;\r\n    this.height = height;\r\n  }\r\n  /**\r\n   * 太陽を落とす\r\n   * HSB色のsaturation/brightnessを太陽の高さと同期させています。\r\n   * 完全に落下したとき、星々がまたたきます。\r\n   */\r\n  letSunGoesDown() {\r\n    const pos = this.sunHeight/this.height;  //上からの位置割合\r\n    let f = [182,86,70],\r\n        t = [23,51,89];\r\n    let from = this.$p5.color(`hsb(${f[0]},${f[1]*pos}%,${f[2]*(1.6-pos)}%)`),\r\n        to   = this.$p5.color(`hsb(${t[0]},${t[1]*pos}%,${t[2]*(1.6-pos)}%)`);\r\n    this.$p5.background(220);\r\n    this._setGradient(from, to);\r\n\r\n    if(pos>0.95)\r\n      this.letStartsTwink();\r\n    this.$p5.colorMode();\r\n  }\r\n  /**\r\n   * 星々をまたたかせる\r\n   */\r\n  letStartsTwink(){\r\n    this.stars.forEach(s => {\r\n      s.twink();\r\n    });\r\n  }\r\n  /** 空にグラデーションを描画するメソッド  */\r\n  _setGradient(from, top) {\r\n    this.$p5.noFill();\r\n    for (let i = 0; i <= this.$p5.windowHeight; i++) {\r\n      var inter = this.$p5.map(i, 0, this.$p5.windowHeight, 0, 1);\r\n      var c = this.$p5.lerpColor(from, top, inter);\r\n      this.$p5.stroke(c);\r\n      this.$p5.line(0, i, this.$p5.windowWidth, i);\r\n    }\r\n  }\r\n}\r\n/**\r\n * 瞬く星\r\n */\r\nclass Star{\r\n  constructor($p){\r\n    this.$p5 = $p\r\n    this.x = this.$p5.random(this.$p5.windowWidth);\r\n    this.y = this.$p5.random(this.$p5.windowHeight - 200);\r\n    this.w = 2;\r\n    this.h = 2;\r\n    setInterval(()=>{\r\n      this.x += (this.$p5.random(10) - 5);\r\n      this.y += (this.$p5.random(10) - 5);\r\n      if (this.w == 2) {\r\n        this.w = 3;\r\n        this.h = 3;\r\n      } else {\r\n        this.w = 2;\r\n        this.h = 2;\r\n      }\r\n    },6000);\r\n  }\r\n  /**\r\n   * またたく\r\n   * 前回値を更新するため、定期的にコールされることを想定しています。\r\n   */\r\n  twink(){\r\n    this.$p5.noStroke();\r\n    this.$p5.fill(255, 255, 0);\r\n    this.$p5.ellipse(this.x, this.y, this.w, this.h);\r\n  }\r\n}\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/sky.js\n// module id = 24\n// module chunks = 5","import { HourGlass } from \"../components/hourglass.js\";\r\nimport { Sky } from \"../components/sky.js\";\r\nimport * as theme from \"../../config/theme.json\";\r\nconst time_limit = 60000; //{number} - トレーニングの制限時間\r\n/**\r\n * 心拍BF\r\n * Libries: p5\r\n * @property {HourGlass} hourglass - 砂時計\r\n * @property {Array<p5.Image>} images - 花の画像配列\r\n * @property {p5.Image} ballImage - 心拍ボールの画像\r\n * @property {Ground} ground - 画面下部のOKバー\r\n * @property {HeartbeatBall} heartbeatBall - 心拍ボール\r\n */\r\nclass Pulse {\r\n  /**\r\n   *\r\n   * @param {p5} p5\r\n   * @param {object} preference - {\"min\": number, \"max\": number}\r\n   */\r\n  constructor(p5, preference) {\r\n    this.$p5 = p5;\r\n    this.waitingForReady = new Promise((resolve, reject) => {\r\n      this.ready = resolve;\r\n    });\r\n    this.waitingForStopped = new Promise((resolve, reject) => {\r\n      this.stop = resolve;\r\n    });\r\n    this.max = preference.max || 75;\r\n    this.min = preference.min || 60;\r\n    this.$p5.theme = theme;\r\n    this.hourGlass = new HourGlass(this.$p5, time_limit, {isReturnEnable:false, isChangeColor:false});\r\n    this.isInitialized = false;\r\n  }\r\n\r\n  /* [p5] preload処理 */\r\n  preload() {\r\n    if (this.$p5.theme.font)\r\n      this.font = this.$p5.loadFont(this.$p5.theme.font.path);\r\n\r\n    this.images = this.$p5.theme.pulse.images\r\n      ? this.$p5.theme.pulse.images.map(i => this.$p5.loadImage(i))\r\n      : null;\r\n    this.ballImage = this.$p5.theme.pulse.ballImage\r\n      ? this.$p5.loadImage(this.$p5.theme.pulse.ballImage)\r\n      : null;\r\n  }\r\n\r\n  /* [p5] setup処理 */\r\n  setup() {\r\n    this.$p5.createCanvas(this.$p5.windowWidth, this.$p5.windowHeight);\r\n    this.$p5.background(this.$p5.theme.color.background);\r\n    this.$p5.frameRate(30);\r\n    this.$p5.noLoop();\r\n    this.$p5.isReady = true;\r\n    if (this.$p5.theme.font) this.$p5.textFont(this.font);\r\n\r\n    this.ground = new Ground(this.$p5, this.images);\r\n    this.sky = new Sky(this.$p5, this.$p5.windowHeight-this.ground.height);\r\n\r\n    this.heartbeatBall = new HeartbeatBall(this.$p5, this.ballImage );\r\n\r\n    this.$p5.imageMode(this.$p5.CENTER);\r\n\r\n    this.ready();\r\n  }\r\n\r\n  /* [p5] スタートボタン押下 */\r\n  start() {\r\n    this.hourGlass.start();\r\n    /* バウンス */\r\n    this.bounce();\r\n\r\n    /* 花 */\r\n    if(!this.ground.flowers)return;\r\n    this.ground.flowers.forEach(f => {\r\n      f.images.forEach(i => {\r\n        i.resize(this.$p5.width / 5, 0);\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 現在の心拍に応じて定期的にボールを弾ませます\r\n   * @returns {number} 現在心拍数\r\n   */\r\n  bounce() {\r\n    this.currentHR = this.getCalcedPulse();\r\n    let interval = 1000;\r\n    if(this.currentHR>0){\r\n      this.heartbeatBall.setBeat();\r\n      interval = 1000 / (this.currentHR / 60);\r\n    }\r\n    this.beatTimer = setTimeout(()=>{\r\n      this.bounce()\r\n    },interval);\r\n    return this.currentHR;\r\n  }\r\n  getCalcedPulse(){\r\n    return (typeof Android !== \"undefined\") ? Android.getPulse() : 75;  //75は標準値\r\n  }\r\n  /* [p5] draw処理 */\r\n  draw() {\r\n    /* For Standalone */\r\n    if (typeof Android === \"undefined\") {\r\n      /* テスト用キー操作 */\r\n      if (\r\n        this.$p5.keyIsDown(this.$p5.UP_ARROW)\r\n        && this.heartbeatBall.basePosition.y > this.$p5.height*(10/100)\r\n      ) {\r\n        this.currentHR += 1;\r\n      }\r\n      if (\r\n        this.$p5.keyIsDown(this.$p5.DOWN_ARROW)\r\n        && this.heartbeatBall.basePosition.y < this.$p5.height*(90/100)\r\n      ) {\r\n        this.currentHR -= 1;\r\n      }\r\n      if (this.$p5.keyIsDown(this.$p5.LEFT_ARROW)) {\r\n        this.heartbeatBall.isUseImage = true;\r\n      }\r\n      if (this.$p5.keyIsDown(this.$p5.RIGHT_ARROW)) {\r\n        this.heartbeatBall.isUseImage = false;\r\n      }\r\n    }\r\n\r\n    /* スプライトの描画 */\r\n    if(this.currentHR>30){ //不正値チェック\r\n      if(!this.isInitialized)/*初期化済み*/\r\n        this._initializeByHr(this.currentHR);\r\n      this.sky.sunHeight = this.heartbeatBall.beat(this.currentHR);\r\n    }\r\n    this.sky.letSunGoesDown();\r\n    if (this.hourGlass)\r\n      this.hourGlass.renderGlass();\r\n\r\n    this.$p5.drawSprite(this.heartbeatBall.sprite);\r\n    this.$p5.drawSprite(this.ground.base);\r\n\r\n    /* アニメーション管理 */\r\n    if(this.ground.flowers){\r\n      if (this.heartbeatBall.sprite.collide(this.ground.base)) {\r\n        this.ground.flowers[this.ground.targetIndex].goToFrame(this.ground.flowers[this.ground.targetIndex].getLastFrame());\r\n      } else {\r\n        this.ground.flowers[this.ground.targetIndex].goToFrame(0);\r\n      }\r\n      if (\r\n        this.ground.flowers[this.ground.targetIndex].getFrame() === this.ground.flowers[this.ground.targetIndex].getLastFrame()\r\n        && this.ground.targetIndex < 5\r\n      ) {\r\n        this.ground.targetIndex += 1;\r\n      } else if (\r\n        this.ground.flowers[this.ground.targetIndex].getFrame() === 0\r\n        && this.ground.targetIndex > 0\r\n      ) {\r\n        this.ground.targetIndex -= 1;\r\n      }\r\n      [1.5, 3.5, 1, 3, 4, 2].forEach((v, i, a) => {\r\n        this.$p5.animation(\r\n          this.ground.flowers[i],\r\n          this.$p5.width * (v / 4) - this.$p5.width / 7.5,\r\n          this.$p5.height * (85 / 100) - this.$p5.width / 10\r\n        );\r\n      });\r\n    }\r\n\r\n    /* 終了処理 */\r\n    if (!this.hourGlass.isOver)\r\n      return;\r\n    this.$p5.noLoop();\r\n    clearInterval(this.beatTimer);\r\n    this.$p5.noCanvas();\r\n    this.$p5.remove();\r\n\r\n    this.stop();\r\n  }\r\n  /** 初期HRによる初期化 */\r\n  _initializeByHr(hr){\r\n    /* max/min補正 */\r\n    if(this.max<hr)\r\n      this.max=hr;\r\n    else if((this.max-hr) > hr*0.1)\r\n      this.max=hr*1.1;\r\n    if(this.min>hr)\r\n      this.min=hr;\r\n    else if((hr-this.min) > hr*0.1)\r\n      this.min=hr*0.9;\r\n    /** 心拍⇒上からの位置を計算する関数 */\r\n    this.heartbeatBall.calcHeightByHr = (hr)=>{\r\n      if(hr>this.max)\r\n        return this.$p5.windowHeight*0.1;\r\n      if(hr<this.min)\r\n        return this.$p5.windowHeight*0.9;\r\n      let x = this.$p5.windowHeight*0.8 / (this.max - this.min);  // window8割/心拍幅\r\n      return  this.$p5.windowHeight*0.1 + (this.max-hr) * x;\r\n    }\r\n    this.isInitialized=true;\r\n  }\r\n}\r\n\r\n/**\r\n * 心拍ボール\r\n * @property {number} size - ボールの大きさ\r\n * @property {p5} p\r\n * @property {number} beatVal - ベースポジションから弾む距離\r\n * @property {number} perBeatVal - 弾むボールが移動する1フレームごとの距離\r\n * @property {number} baseHR - 開始時の心拍\r\n * @property {Object} basePosition - ボールの基準位置\r\n * @property {p5.Sprite} sprite - ボールのスプライト\r\n */\r\nclass HeartbeatBall {\r\n  constructor(p, image = null) {\r\n    this.size = p.height / 10;\r\n    this.p5 = p;\r\n    this.beatVal = 0;\r\n    this.perBeatVal = 0;\r\n    this.basePosition = {\r\n      x: p.width / 2,\r\n      y: p.height * 0\r\n    };\r\n    this.calcHeightByHr = null;//function\r\n    /* For Standalone */\r\n    if (typeof Android === \"undefined\") {\r\n      this.isUseImage = false;\r\n    }\r\n\r\n    this.sprite = p.createSprite(\r\n      this.basePosition.x,\r\n      this.basePosition.y,\r\n      this.size,\r\n      this.size\r\n    );\r\n    this.sprite.draw = () => {\r\n      /* For Standalone */\r\n      if (typeof Android !== \"undefined\") {\r\n        if (this.isUseImage) {\r\n          p.image(image, 0, 0, this.size, this.size);\r\n          return;\r\n        }\r\n        p.fill(\"#FFA000\");\r\n        p.noStroke();\r\n        p.ellipse(0, 0, this.size, this.size);\r\n        return;\r\n      }\r\n      if (image) {\r\n        p.image(image, 0, 0, this.size, this.size);\r\n        return;\r\n      }\r\n      p.fill(\"#FF6D00\");\r\n      p.noStroke();\r\n      p.ellipse(0, 0, this.size, this.size);\r\n    };\r\n  }\r\n\r\n  /* 振動幅を設定 */\r\n  setBeat() {\r\n    this.beatVal = 1 - this.basePosition.y / this.p5.height;\r\n    this.perBeatVal = this.beatVal / 10;\r\n  }\r\n  /* ボールの位置を更新 */\r\n  beat(currentHR) {\r\n    /* 不正値チェック */\r\n    if(currentHR<1)return;\r\n    if(!this.baseHR)\r\n      this.baseHR=currentHR;\r\n    this.basePosition.y = this.calcHeightByHr(currentHR);\r\n    // let y = this.p5.height*(3/10) - ((currentHR-this.baseHR)/this.baseHR * 5) * (this.p5.height/2);\r\n    // this.basePosition.y = Math.max(\r\n    //   this.p5.height*(10/100),\r\n    //   Math.min(y, this.p5.height*(90/100))\r\n    // );\r\n    if (this.beatVal > 0) {\r\n      this.beatVal -= this.perBeatVal;\r\n    }\r\n    this.sprite.position.y = this.basePosition.y - (this.p5.height*(5/100) * this.beatVal);\r\n    return this.sprite.position.y;\r\n  }\r\n}\r\n\r\n/**\r\n * OKライン\r\n * @property {p5.Sprite} base - OKラインのスプライト\r\n * @property {number} targetIndex - アニメーション対象のインデックス\r\n * @property {Array<p5.Animation>} flowers - 花ごとのアニメーション配列\r\n */\r\nclass Ground {\r\n  constructor(p, images=null) {\r\n    this.height = p.windowHeight * (15 / 100);\r\n    this.base = p.createSprite(\r\n      p.windowWidth / 2,\r\n      p.windowHeight * (92.5 / 100),\r\n      p.windowWidth,\r\n      this.height\r\n    );\r\n    this.base.shapeColor = p.color(\"#5D4037\");\r\n\r\n    this.targetIndex = 0;\r\n    if(!images)return;\r\n    /* 花 */\r\n    this.flowers = [];\r\n    [1, 2, 3, 4, 5, 6].forEach((v, i, a) => {\r\n      let flower = p.loadAnimation(...images);\r\n      flower.looping = false;\r\n      flower.stop();\r\n      this.flowers.push(flower);\r\n    });\r\n  }\r\n}\r\n\r\nexport class PulseGuide {\r\n  constructor(pulse){\r\n    this.range = JSON.stringify(pulse);\r\n  }\r\n  async start() {\r\n    new p5($p5 => {\r\n      this.training = new Pulse($p5, this.range);\r\n      $p5.preload = this.training.preload.bind(this.training);\r\n      $p5.setup = this.training.setup.bind(this.training);\r\n      $p5.draw = this.training.draw.bind(this.training);\r\n    }, \"content\");\r\n    await this.training.waitingForReady;\r\n\r\n    this.training.start();\r\n\r\n    await this.training.waitingForStopped;\r\n  }\r\n}\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/misc/NIL001.js\n// module id = 7\n// module chunks = 5","module.exports = {\"color\":{\"primary\":\"#ffe600\",\"secondary\":\"#ed7229\",\"positioner\":\"#ffffff\",\"positionerLight\":\"#ffffff\",\"positionerText\":\"#505050\",\"positionerPushedText\":\"#dfdfdf\",\"domKeyOutline\":\"#505050\",\"domKeyText\":\"#505050\",\"domKeyBackground\":\"#ffffff\",\"pushableFlash\":\"#ff0000\",\"insideCircle\":\"#e6e6e6\",\"outsideCircle\":\"#c8c8c8\",\"accent\":\"#37b595\",\"primaryText\":\"#606060\",\"secondaryText\":\"#424242\",\"accentText\":\"#000000\",\"background\":\"#ffffff\",\"empty\":\"#dfdfdf\",\"shadow\":\"#c5c5c6\",\"circles\":\"#ed7769\",\"crosses\":\"#22587a\"},\"option\":{\"vibe\":\"off\",\"sound\":\"on\",\"isReturnEnable\":false},\"tengrid\":{\"borderRadius\":\"0px\"},\"font\":{\"family\":\"LocalFont\",\"path\":\"./assets/font/mplus-1p-regular.woff\"},\"pulse\":{\"images\":null,\"ballImage\":null},\"NFB001\":{\"level\":\"2\"},\"NFB002\":{\"level\":\"2\",\"symbolList\":[\"〇\",\"☆\",\"▽\",\"■\",\"◇\",\"×\",\"△\",\"※\",\"◎\",\"□\"]},\"NFB003\":{\"level\":\"2\",\"pushList\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\"]]},\"NFB004\":{\"level\":\"3\",\"marker\":\"●\"},\"NFB005\":{\"level\":\"4\"},\"NFB006\":{\"level\":\"4\"},\"NFB007\":{\"level\":\"1\"},\"NFB008\":{\"level\":\"1\",\"symbolList\":[\"〇\",\"☆\",\"▽\",\"■\",\"◇\",\"×\",\"△\",\"※\",\"◎\",\"□\"]},\"NFB009\":{\"level\":\"1\"},\"NFB010\":{\"level\":\"3\",\"threshold\":\"500\"},\"NFB011\":{\"level\":\"2\",\"threshold\":\"500\",\"isUseImage\":true,\"iconfont\":\"tag_faces\",\"imagePath\":\"assets/image/face1.png\"},\"NFB012\":{\"level\":\"1\",\"isUseImage\":false,\"image1\":{\"iconfont\":\"tag_faces\",\"imagePath\":\"./assets/image/push1.png\",\"isPositive\":true},\"image2\":{\"iconfont\":\"tag_faces\",\"imagePath\":\"./assets/image/unpush1.png\",\"isPositive\":false},\"image3\":{\"iconfont\":\"brightness_high\",\"imagePath\":\"./assets/image/push2.png\",\"isPositive\":true},\"image4\":{\"iconfont\":\"brightness_high\",\"imagePath\":\"./assets/image/unpush2.png\",\"isPositive\":false},\"image5\":{\"iconfont\":\"bug_report\",\"imagePath\":\"./assets/image/push3.png\",\"isPositive\":true},\"image6\":{\"iconfont\":\"bug_report\",\"imagePath\":\"./assets/image/unpush3.png\",\"isPositive\":false}},\"NFB013\":{\"level\":\"1\",\"threshold\":\"1000\",\"isUseImage\":true,\"image1\":{\"iconfont\":\"tag_faces\",\"imagePath\":\"./assets/image/face1.png\",\"isPositive\":true},\"image2\":{\"iconfont\":\"sentiment_very_dissatisfied\",\"imagePath\":\"./assets/image/face2.png\",\"isPositive\":false}},\"NFB014\":{\"level\":\"1\",\"pushList\":[[\"1\",\"あ\",\"2\",\"い\",\"3\",\"う\",\"4\",\"え\",\"5\",\"お\",\"6\",\"か\",\"7\",\"き\",\"8\",\"く\",\"9\",\"け\",\"10\",\"こ\"]]},\"NFB015\":{\"level\":\"1\"},\"NFB016\":{\"level\":\"1\"},\"NFB017\":{\"level\":\"1\"},\"NFB018\":{\"level\":\"1\",\"threshold\":\"1000\",\"isUseImage\":false,\"iconfont\":\"star\",\"imagePath\":\"./assets/image/face1.png\",\"isPositive\":true},\"NFB019\":{\"level\":\"1\"},\"NFB020\":{\"level\":\"1\"},\"NFB021\":{\"level\":\"1\"},\"NFB022\":{\"level\":\"1\"},\"NFB023\":{\"level\":\"1\",\"flowingList\":[{\"name\":\"犬\",\"image\":\"./assets/image/dog.png\"},{\"name\":\"馬\",\"image\":\"./assets/image/horse.png\"},{\"name\":\"猿\",\"image\":\"./assets/image/monkey.png\"},{\"name\":\"猫\",\"image\":\"./assets/image/cat.png\"},{\"name\":\"兎\",\"image\":\"./assets/image/rabbit.png\"},{\"name\":\"鼠\",\"image\":\"./assets/image/rat.png\"}]},\"NFB024\":{\"level\":\"1\"},\"NFB025\":{\"level\":\"1\"},\"NFB026\":{\"level\":\"1\"},\"NFB027\":{\"level\":\"1\"},\"NFB028\":{\"level\":\"1\"},\"NFB029\":{\"level\":\"1\"},\"NFB030\":{\"level\":\"1\",\"flowingList\":[{\"name\":\"いぬ\",\"image\":\"./assets/image/dog.png\"},{\"name\":\"うま\",\"image\":\"./assets/image/horse.png\"},{\"name\":\"ねこ\",\"image\":\"./assets/image/cat.png\"}]}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./config/theme.json\n// module id = 9\n// module chunks = 0 1 2 4 5 6"],"sourceRoot":""}